server:
  port: 8080
  servlet:
    context-path: /api/user

spring:
  application:
    name: user-module
  datasource:
    url: jdbc:mysql://localhost:3306/user_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai&characterEncoding=UTF-8
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      minimum-idle: 1
      maximum-pool-size: 10
#      当应用（比如 Spring Boot 项目）频繁访问数据库时，每次都新建和关闭连接的开销很大。
#      因此，我们使用 连接池 (Connection Pool) 来维护一批可复用的连接。
#
#      HikariCP 就是一个高性能的连接池组件。
#      这些参数控制着连接池中的连接数量和行为。
#
#      minimum-idle	最小空闲连接数	指定连接池中保持的最小空闲连接数量。当空闲连接低于这个值时，HikariCP 会自动创建新连接。比如设为 1，就保证至少有一个连接是空闲可用的。
#      maximum-pool-size	最大连接池大小	指定连接池中允许的最大连接数量（包括空闲和正在使用的连接）。超过这个数量的请求会被阻塞等待可用连接。比如设为 10，最多允许10个连接同时被使用。
  data:
    redis:
      host: localhost  # ✅ 改为localhost，因为Redis容器端口已映射到主机
      port: 6379
      password: 
      database: 0
      timeout: 5000ms  # 增加超时时间
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
        shutdown-timeout: 200ms

  mail:
    host: smtp.qq.com
    port: 465  # QQ邮箱SSL端口
    username: 3388609154@qq.com
    password: irdgfajaditpdcbc   # QQ邮箱授权码（非登录密码）
    protocol: smtps  # 使用SSL协议
    default-encoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true  # 启用认证
          ssl:
            enable: true  # 启用SSL
            required: true  # 要求SSL
          socketFactory:
            class: javax.net.ssl.SSLSocketFactory
            port: 465  # SSL端口
            fallback: false  # 禁用降级
          connectiontimeout: 10000  # 连接超时（毫秒）
          timeout: 10000  # 读取超时（毫秒）
          writetimeout: 10000  # 写入超时（毫秒）
          starttls:
            enable: false  # 禁用STARTTLS（使用SSL）
            required: false
    from: 3388609154@qq.com  # 发件人邮箱

# MyBatis configuration
mybatis:
  configuration:
    map-underscore-to-camel-case: true
  mapper-locations: classpath:mapper/*.xml

# JWT configuration
jwt:
  expiration: 86400000 # 24 hours in milliseconds


# Email configuration (QQ邮箱)
app:
  mail:
    verify-switch-off: false  # true = 开发模式（验证码在日志中显示，不发送邮件）；false = 生产模式（实际发送QQ邮件）
    # 注意：生产模式需要正确配置QQ邮箱SMTP（见上面的spring.mail配置）
    # QQ邮箱授权码获取方法：登录QQ邮箱 -> 设置 -> 账户 -> 开启SMTP服务 -> 生成授权码




## Email configuration (SendGrid)
#sendgrid:
#  api-key: YOUR_SENDGRID_API_KEY # Replace with your SendGrid API key
#  from-email: no-reply@example.com # Replace with your sender email

# Spring Boot Actuator (监控和健康检查)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized
  metrics:
    export:
      prometheus:
        enabled: false  # 如需Prometheus监控，设置为true

# Swagger/OpenAPI 配置
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    tags-sorter: alpha
    operations-sorter: alpha

logging:
  level:
    com.user: DEBUG
    org.springframework: INFO

